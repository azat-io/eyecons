import { describe, expect, it } from 'vitest'
import dedent from 'dedent'

import { parseSvg } from '../../extension/colorize/parse-svg'

describe('parseSvg', () => {
  it('parses svg', () => {
    let svg = dedent`
      <svg
        xmlns="http://www.w3.org/2000/svg"
        viewBox="0 0 256 256"
        fill="none"
      >
        <rect
          fill="#F06529"
          height="226"
          width="226"
          rx="46"
          x="15"
          y="15"
        />
        <path
          d="M190.664 79.9576H91.3599L93.7257 106.547H188.313L181.186 186.243L127.949 201L74.7848 186.243L71.1553 145.469H97.2082L99.0597 166.194L127.963 173.984L128.022 173.969L156.94 166.164L159.938 132.505H69.9945L63 54H193L190.664 79.9576Z"
          fill="white"
        />
      </svg>`

    expect(parseSvg(svg)).toEqual({
      background: '#F06529',
      foreground: 'white',
    })
  })

  it("returns null if if there's no obvious color", () => {
    let svg = dedent`
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256" fill="none">
        <rect x="14" y="14" width="228" height="228" rx="46" fill="white" />
        <path
          d="M30.8709 24.398L67.8444 61.3721H179.51L132.138 14H86.68C61.7852 14 49.3378 14 39.7628 18.6907C36.5695 20.2551 33.5891 22.174 30.8709 24.398Z"
          fill="#8CD636"
        />
        <path
          d="M24.3984 225.129C22.1742 222.411 20.2552 219.431 18.6907 216.237C14 206.662 14 194.215 14 169.32V86.68C14 61.7852 14 49.3378 18.6907 39.7628C20.255 36.5696 22.1738 33.5893 24.3978 30.8712L121.527 128L24.3984 225.129Z"
          fill="#596277"
        />
        <path
          d="M225.129 231.602C222.411 233.826 219.43 235.745 216.237 237.309C206.662 242 194.215 242 169.32 242H86.68C61.7852 242 49.3378 242 39.7628 237.309C36.5698 235.745 33.5895 233.826 30.8715 231.602L128 134.473L225.129 231.602Z"
          fill="#5FB4CB"
        />
        <path
          d="M242 144.578V169.32C242 194.215 242 206.662 237.309 216.237C235.745 219.431 233.826 222.411 231.602 225.13L196.525 190.052L242 144.578Z"
          fill="#EEA400"
        />
        <path
          d="M242 123.862V131.627L190.05 183.577L134.472 127.998L190.304 72.1659L242 123.862Z"
          fill="#8CD636"
        />
        <path
          d="M145.084 14H169.32C194.215 14 206.662 14 216.237 18.6907C225.405 23.1819 232.818 30.5951 237.309 39.7628C242 49.3378 242 61.7852 242 86.68V110.915L145.084 14Z"
          fill="#5FB4CB"
        />
        <path d="M128 121.527L179 70.5267H76.9998L128 121.527Z" fill="#EEA400" />
      </svg>
    `

    expect(parseSvg(svg)).toBeNull()
  })
})
